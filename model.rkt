#lang racket

(define SINGLE-CHAR-TOKENS
  (list #\+ #\− #\× #\= #\? #\λ #\≜ #\Ω #\∷ #\← #\→ #\∅ #\∘ #\⊢ #\_ #\‹ #\› #\∧ #\∨ #\¬ #\( #\)))

(define (single-char-token? v)
  (member v SINGLE-CHAR-TOKENS))

(define TERMINAL-EXPR-TOKEN-LITERAL-MAP (hash #\∅ '(list) #\_ '_))

(define (terminal-expr-token? v)
  (hash-has-key? TERMINAL-EXPR-TOKEN-LITERAL-MAP v))

(define (terminal-expr-literal token)
  (hash-ref TERMINAL-EXPR-TOKEN-LITERAL-MAP token))

(define PAREN-EXPR-TOKEN-SYMBOL-MAP
  (hash #\+
        '(expr expr)
        #\−
        '(expr expr)
        #\×
        '(expr expr)
        #\‹
        '(expr expr)
        #\›
        '(expr expr)
        #\=
        '(expr expr)
        #\=
        '(expr expr)
        ;; control flow
        #\?
        '(expr expr expr)
        #\λ
        '(identifier expr)
        #\≜
        '(identifier expr expr)
        #\Ω
        '(expr)
        ;; lists
        #\∷
        '(expr expr)
        #\←
        '(expr)
        #\→
        '(expr)
        #\∘
        '(expr)
        ;; logic
        #\∧
        '(expr expr)
        #\∨
        '(expr expr)
        #\¬
        '(expr)
        ;; pattern matching
        #\⊢
        '(expr match-clause)))

(define (paren-expr-token? v)
  (hash-has-key? PAREN-EXPR-TOKEN-SYMBOL-MAP v))

(define (paren-expr-symbol token)
  "Gets the symbols generated by a specific parentheses expression token."
  (hash-ref PAREN-EXPR-TOKEN-SYMBOL-MAP token))

(define PAREN-EXPR-TOKEN-LITERAL-MAP
  (hash #\+
        +
        ;;----;;
        #\−
        -
        ;;----;;
        #\×
        *
        ;;----;;
        #\=
        equal?
        ;;----;;
        #\?
        'if
        ;;----;;
        #\‹
        <
        ;;----;;
        #\›
        >
        ;;----;;
        #\∧
        'and
        ;;----;;
        #\∨
        'or
        ;;----;;
        #\¬
        not
        ;;----;;
        #\Ω
        'turing-combinator
        ;;----;;
        #\∷
        'cons
        ;;----;;
        #\←
        'car
        ;;----;;
        #\→
        'cdr
        ;;----;;
        #\∅
        '(list)
        ;;----;;
        #\∘
        'null?
        ;;----;;
        #\⊢
        'match))

(define (paren-expr-literal token)
  "Gets the symbols generated by a specific parentheses expression token."
  (hash-ref PAREN-EXPR-TOKEN-LITERAL-MAP token))

(provide SINGLE-CHAR-TOKENS
         TERMINAL-EXPR-TOKEN-LITERAL-MAP
         PAREN-EXPR-TOKEN-SYMBOL-MAP
         PAREN-EXPR-TOKEN-LITERAL-MAP
         single-char-token?
         terminal-expr-literal
         terminal-expr-token?
         paren-expr-symbol
         paren-expr-literal
         paren-expr-token?)
